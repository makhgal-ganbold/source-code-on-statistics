---
title: "Олон хэмжээст өгөгдлийн статистик шинжилгээ хичээлийн нэмэлт жишээ"
subtitle: "Хөнгөн атлетикийн гүйлтийн төрлөөрх улс орнуудын үндэсний рекорд амжилт"
author: "Г.Махгал"
date: "2022 оны 4 сарын 11"
header-includes:
   - \usepackage[mongolian]{babel}
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
    fig_caption: yes
    citation_package: biblatex
bibliography: bibliography.bib
abstract: Хөнгөн атлетикийн гүйлтийн төрөлд тамирчид 100, 200, 400, 800, 1500, 5000, 10000 метр зайд уралддаг. Хөндлөнгөөс харахад уралдах зайн энэхүү ангилал ихэдсэн мэт санагдана. Иймд спортын энэхүү төрөлд харгалзах өгөгдөл дээр корреляцийн шинжилгээ болон гол хэсгийн шинжилгээ хийж дээр дурдсан уралдах зайн ангиллуудын холбоо хамаарал болон эдгээр олон төрлийн зайн мэдээлэл угтаа хэчнээн хүчин зүйлээр тодорхойлогдох цаашилбал тэдгээр олон төрлийн зайн уралдааныг цөөлж болох эсэх буюу аль зайгаар тэмцээн зохиож тамирчдын амжилтыг бүртгэвэл оновчтой болох тухай статистик дүгнэлт гаргана.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, fig.align='center', fig.height = 2, fig.width = 4, fig.env = "figure", fig.pos="ht", fig.ext='pdf')
options(xtable.comment = FALSE)
```

# Өгөгдөл

Хөнгөн атлетикийн гүйлтийн төрлөөрх 54 улс орны үндэсний рекорд амжилтыг 2005 оны байдлаар, м/с-ээр илэрхийлсэн өгөгдөл авч үзнэ.

```{r load data,echo=TRUE}
X <- read.csv(file = "data.csv", check.names = FALSE)
```

Өгөгдлийг файлаас ачаалж, датафрейм хэлбэртэй объект болгон `X` гэсэн нэрээр ажлын огторгуйд хадгалав. Датафреймын эхний хэдэн мөрийг Хүснэгт \ref{table:some-rows-of-data} дээр харуулав.

```{r the first rows of data,results='asis'}
Z <- as.matrix(X[1:6,])
xtable::xtable(x = Z, caption = "Өгөгдлийн эхний 6 мөр", label = "table:some-rows-of-data", display = rep(c("d", "s", "f"), times = c(1, 1, 7)), digits = 1, booktabs = TRUE)
rm(Z)
```

Датафреймын эхний багана бидэнд шаардлагагүй тул түүнийг зайлуулна. Бас баганын нэрд орсон кирилл үсгээс болж RMarkdown ашиглаж тайлан бэлдэх үед гарах анхааруулгаас зайлсхийхийн тулд баганын нэрсийг өөрчлөв.

```{r,echo=TRUE}
X <- X[-1]
colnames(X) <- c(100, 200, 400, 800, 1500, 5000, 10000)
```

# Корреляцийн шинжилгээ

`r names(X)` хувьсагчдын хувьд түүврийн корреляцийн матрицыг дараах байдлаар олж болно.

```{r correlation,echo=TRUE}
R <- cor(X)
```

Ийнхүү олсон түүврийн корреляцийн матриц $$R=\left(
```{r,results='asis'}
print(xtable::xtable(R, align = NULL, digits = 2), floating = FALSE, tabular.environment="array", hline.after = NULL, include.rownames = FALSE, include.colnames = FALSE)
```
\right)$$ байна. Матрицаас `r names(X)` хувьсагчид өөр хоорондоо маш өндөр, шууд хамааралтай болох нь харагдана. Иймд эдгээр хувьсагчдын холбоо хамаарлыг цааш үргэлжлүүлэн судалбал зохино.

# Гол хэсгийн шинжилгээ

Корреляцийн шинжилгээгээр `r names(X)` хувьсагчид хоорондоо хүчтэй хамааралтай гэдгийг тогтоосон. Иймд тэдгээр хувьсагчдын холбоо хамаарлыг цааш нь нарийвчлан шинжилж болох юм.

Эхлээд дээрх нэр бүхий `r ncol(X)` хувьсагч угтаа хэчнээн хүчин зүйлээр тодорхойлогдож буйг олж тогтооно. Үүнд гол хэсгийн шинжилгээ [@makhgal2017, \S 3] хэрэг болно. Энэхүү шинжилгээг `FactoMineR` [@JSSv025i01] болон `factoextra` [@factoextra] багц ашиглаж хийх боломжтой. Эдгээр багцууд нь гол хэсгийн шинжилгээний олон талын үр дүнг хялбар тушаалаар гаргаж харуулдаг.

```{r PCA,echo=TRUE}
pca <- FactoMineR::PCA(X = X, scale.unit = TRUE, graph = FALSE, ncp = 7)
```

Шинжилгээнд оруулсан хувьсагчид хэмжээсийн төрөл, масштабын хувьд бүгд ижил, тодруулбал м/c гэсэн нэгжээр илэрхийлэгдсэн тул мастабын ялгаатай байдал арилгах буюу стандарт хувиргалт хийх шаардлагагүй юм. Иймд тус функцийг `scale.unit = FALSE` аргументтайгаар дуудаж болно. Харин хувьсагчдын масштаб ялгаатай буюу өөр хэмжээсээр хэмжсэн өгөгдлийн хувьд `scale.unit = TRUE` аргумент дамжуулна. Ийм утга дамжуулах буюу хувьсагч дээр стандарт хувиргалт хийх нь бүх хувьсагчдыг ижил тэгш эрхтэй болгож буй явдал юм.

Энэхүү өгөгдөл дэх хувьсагчдын хувьд ойрын зайд илүү өндөр хурд гарах бол харин хол зайд бага дундаж хурд гарах тул хувьсагчдын масштаб ялгаатай гэж үзлээ. Иймд хувьсагчид дээр стандарт хувиргалт хийх буюу `PCA()` функцийг `scale.unit = TRUE` гэсэн байдлаар дуудах нь зүйтэй.

> Ийнхүү хувьсагчид дээр стандарт хувиргалт хийх буюу хувьсагчдыг тэгш эрхтэй байдлаар авах уу гэдэг талаар хоёронтаа бодож байж эцсийн шийдвэрт хүрлээ.

Түүнчлэн шинжилгээнд 7 хувьсагч оруулсан тул 7 гол хэсэг олдох бөгөөд эдгээр бүгдийг эцсийн үр дүнд тусгуулахын тулд `ncp` аргументаар 7 гэсэн утга дамжууллаа.

## Ялгаж авах гол хэсгийн тоо

Хэчнээн хүчин зүйл буюу гол хэсэг шаардлагатайг $\lambda_1,\ldots,\lambda_p$ хувийн утгууд буюу гол хэсгүүдийн дисперсүүдийн тусламжтай зохиогдох $$\psi_q=\frac{\lambda_1+\ldots+\lambda_q}{\lambda_1+\ldots+\lambda_p}\cdot100\% \qquad q=1,\ldots,p$$ харьцаа дээр үндэслэж олдог. Тэдгээр хувийн утгууд болон энэхүү статистикийг `FactoMineR::PCA()` функцийн буцаах утгын `eig` элемент дэх матрицын эхний болон сүүлийн багануудаас харж болно. Үүнийг хэвлэж харахын тулд `pca$eig` хэлбэртэй тушаал өгнө.

```{r,results='asis'}
xtable::xtable(x = pca$eig, caption = "Хувийн утгууд", label = "table:eigen-values", display = rep(c("s", "f"), times = c(1, 3)), digits = 5, booktabs = TRUE)
```

Эндээс гарах үр дүнг Хүснэгт \ref{table:eigen-values} дээр харуулав. Хүснэгтийн нэг дүгээр баганад буй хувийн утгуудыг диаграммаар харуулбал зохимжтой. Үүний тулд дараах байдалтай тушаал өгнө. Гарсан үр дүнг Зураг \ref{figure:scree-plot-eigs} дээрээс харна уу.

```{r echo=TRUE,fig.cap="\\label{figure:scree-plot-eigs}Хувийн утгууд"}
factoextra::fviz_screeplot(pca, choice = "eigenvalue", addlabels = TRUE, ylim = c(0,7))
```

Харин хувийн утга тус бүр нь нийт хувийн утгуудын нийлбэрийн хэчнээн хувийг эзэлж буйг өөрөөр хэлбэл гол хэсэг тус бүр нийт дисперсийн хэдэн хувийг илэрхийлж буйг хоёр дугаар багана дахь утгууд харуулах бөгөөд үүгээр диаграмм байгуулахын тулд дараах хэлбэртэй тушаал өгнө. Байгуулсан диаграммыг Зураг \ref{figure:scree-plot-vars} дээрээс харна уу.

```{r echo=TRUE,fig.cap="\\label{figure:scree-plot-vars}Нийт хувийн утгуудын дотор хувийн утга тус бүрийн эзлэх хувь"}
factoextra::fviz_screeplot(pca, choice = "variance", addlabels = TRUE, ylim = c(0,100))
```

Эцэст нь гурав дугаар баганыг харвал $\psi_2\approx92.08$ буюу эхний хоёр гол хэсэг хамтдаа нийлээд нийт дисперсийн 90 гаруй хувийг эзэлж байна. Иймд дээрх `r ncol(X)` хувьсагчид агуулагдах мэдээлэл үндсэндээ хоёр хүчин зүйлээр тодорхойлогдоно хэмээн дүгнэж болно.

## Гол хэсгүүдийг тайлбарлах нь

### Анхны хувьсагчид болон гол хэсгүүд хоорондын корреляц

Гарсан үр дүнг тайлбарлахын тулд анхны хувьсагчид болон гол хэсгүүд хоорондын корреляцаар байгуулсан диаграмм байгуулсанаа Зураг \ref{figure:pca-correlation} дээр харуулав. Тус диаграммыг байгуулахын тулд дараах тушаал өгнө.

```{r echo=TRUE,fig.height=3.75,fig.cap="\\label{figure:pca-correlation}Эхний хоёр гол хэсэг болон хувьсагч хоорондын корреляц"}
factoextra::fviz_pca_var(pca)
```

> Энэхүү корреляцийн диаграмм нь зөвхөн `scale.unit = TRUE` үед гарна.

Гол хэсгийн шинжилгээний корреляцийн диаграммыг харвал бүх хувьсагчид эхний гол хэсэгтэй маш өндөр, шууд хамааралтай байна. Харин хоёр дугаар гол хэсгийн зүгээс харвал ойрын зайн төрлүүд тус гол хэсэгтэй шууд хамааралтай, бусад төрлүүд урвуу хамааралтай ажээ. Бас энэхүү холбоо хамаарлаараа илэрхий хоёр тусдаа бүлэг үүсгэж байна. Эхний бүлэгт 100, 200, 400 метрийн төрлүүд харин нөгөө бүлэгт бусад төрлүүд багтаж байна. Ийнхүү ойрын болон холын зайн тус бүр нэг төрөлд тамирчдыг уралдуулбал зохимжтой гэсэн статистик дүгнэлт гарлаа.

### Гол хэсэг дээрх хувьсагч тус бүрийн оролцоо

Гол хэсэг дээрх хувьсагч тус бүрийн оролцоо нь `FactoMineR::PCA()` функцийн буцаах утгын `var` элементийн `contrib` утга дотор байдаг. Тус функцийн утгыг `pca` гэсэн нэртэй хувьсагч буюу объект байдлаар ажлын огторгуйд хадгалсан тул уг оролцоог `print(pca$var$contrib)` тушаалаар хэвлэж харах боломжтой. Үүнийг Хүснэгт \ref{table:contribution} дээр байрлууллаа.

```{r,results='asis'}
xtable::xtable(x = pca$var$contrib, caption = "Гол хэсэг дээрх хувьсагч тус бүрийн оролцоо", label = "table:contribution", display = rep(c("s", "f"), times = c(1, 7)), digits = 2, booktabs = TRUE)
```

Хүснэгтийн эхний баганыг харвал хувьсагчдад харгалзах утгууд ойролцоо байна. Энэ нь нэг дүгээр гол хэсэг дээрх хувьсагчдын оролцоо жигдхэн байна гэсэн үг юм. Хоёр дугаар гол хэсгийн хувьд 800 болон 1500 метрийн төрлүүдээс бусдынх оролцоо өндөр байна. Ийнхүү ойрын болон холын зайн төрлүүдийн ялгаа нь хоёр дугаар хүчин зүйлээр тайлбарлагдаж байна гэсэн дүгнэлт гарч буй нь корреляцийн диаграммаас ажигласантай тохирч байна. Харин 800 ба 1500 метр гэсэн дундын зайн ангиллууд ач холбогдол нь маш бага байсан 4 ба 5 дугаар гол хэсэг тус бүртэй уялдаж байна. Мөн энд 400 метрийн зай нь 3 дугаар гол хэсэгтэй илүү уялдаатай байгаа тэмдэглэх нь зүйтэй. Хэрэв энэхүү хоёр статистик дүгнэлт дээр ач холбогдол өгнө гэвэл дундын зайн ангилал нэмж болох юм.

# Дүгнэлт

Хөнгөн атлетикийн гүйлтийн төрлөөрх 54 улс орны үндэсний рекорд амжилтыг 2005 оны байдлаар, м/с-ээр илэрхийлсэн өгөгдөл дээрх гол хэсгийн шинжилгээнээс дараах үр дүн гарлаа.

1. Гүйлтийн төрлийг уралдах зайгаар нь `r ncol(X)` ангилалд хуваасан нь хэт ихдэж байна.
2. Ойрын эсвэл холын зай гэсэн хоёр ангид хуваавал судалгаанд ашигласан өгөгдөл дэх нийт мэдээллийн 90 гаруй хувийг хамрахаар байна.
3. Хэрэв дундын зай гэсэн анги нэмбэл гол хэсгийн шинжилгээгээр олж тогтоосон 5 хүчин зүйлийн нөлөөг харгалзан үзсэн явдал болох бөгөөд энэ нь нийт өгөгдөл дэх дисперсийн 1 гаруйхан хувийг үл тооцно гэсэн үг юм.

Ийнхүү хөнгөн атлетикийн гүйлтийн төрөлд тамирчдын уралдах зай нь ойр, дунд, хол гэсэн гурван шат бүхий ангилалтай байвал зохимжтой гэсэн статистик дүгнэлт гарав.

# Ашигласан материал